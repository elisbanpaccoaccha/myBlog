---
import { Sun, Menu } from "@lucide/astro";
const pathname = Astro.url.pathname;

const navItems = [
  { label: "Home", href: "/home" },
  { label: "About", href: "/about" },
  { label: "Blog", href: "/" },
  { label: "Notes", href: "/notes" },
];
---

<script>
  const onDark = document.getElementById("toggle");
  if (localStorage.getItem("theme") === "dark") {
    document.documentElement.classList.add("dark");
  }
  if (localStorage.getItem("theme") === "light") {
    document.documentElement.classList.remove("dark");
  }
  if (localStorage.getItem("theme") === null) {
    localStorage.setItem("theme", "light");
  }
  onDark?.addEventListener("click", () => {
    document.documentElement.classList.toggle("dark");
    if (document.documentElement.classList.contains("dark")) {
      localStorage.setItem("theme", "dark");
    } else {
      localStorage.setItem("theme", "light");
    }
  });

  const menuBtn = document.getElementById("menu-btn");
  const mobileMenu = document.getElementById("mobile-menu");

  menuBtn?.addEventListener("click", () => {
    mobileMenu?.classList.toggle("hidden");
  });
</script>

<header
  class="sticky top-0 z-50 w-full backdrop-blur-md dark:backdrop-blur-sm bg-background-light/90 dark:bg-background-dark/90 border-b border-border-light dark:border-border-dark"
>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex justify-between items-center h-16">
      <div
        class="flex items-center gap-2 group cursor-pointer bg-transparent dark:text-white text-black"
      >
        <span class="font-bold text-xl">&lt;</span>
        <span class="font-bold text-lg">MyBlog</span>
        <span class="font-bold text-xl">/&gt;</span>
      </div>

      <nav class="hidden md:flex space-x-8 items-center">
        {
          navItems.map((link) => {
            const isActive = pathname === link.href;

            return (
              <a
                class:list={[
                  "text-sm font-medium transition-colors relative group flex items-center",
                  isActive
                    ? "text-blue-600 dark:text-blue-400 font-bold"
                    : "hover:text-blue-600 dark:hover:text-blue-400 text-gray-600 dark:text-gray-300",
                ]}
                href={link.href}
              >
                <span
                  class:list={[
                    "mr-1 transition-opacity text-slate-400",
                    isActive
                      ? "opacity-100"
                      : "opacity-0 group-hover:opacity-100",
                  ]}
                >
                  ./
                </span>
                {link.label}
              </a>
            );
          })
        }
      </nav>

      <div class="flex items-center space-x-4">
        <button
          class="p-2 rounded-lg hover:bg-slate-200 dark:hover:bg-slate-800 transition-colors text-slate-600 dark:text-slate-400"
          id="toggle"
        >
          <Sun class="w-5 h-5" />
        </button>
        <button
          id="menu-btn"
          class="md:hidden p-2 rounded-lg hover:bg-slate-200 dark:hover:bg-slate-800 transition-colors text-slate-600 dark:text-slate-400"
          aria-label="Open Menu"
        >
          <Menu class="w-5 h-5" />
        </button>
      </div>
    </div>
  </div>

  <div
    id="mobile-menu"
    class="hidden absolute top-16 left-0 w-full z-40 bg-white/95 dark:bg-[#0a0a0a]/95 backdrop-blur-md border-b border-gray-200 dark:border-gray-800 shadow-2xl transition-all"
  >
    <div class="flex flex-col p-4 space-y-2">
      {
        navItems.map((link) => {
          const isActive = pathname === link.href;

          return (
            <a
              class:list={[
                "flex items-center gap-2 px-4 py-3 rounded-lg transition-colors font-mono",
                isActive
                  ? "bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400 font-bold border border-blue-100 dark:border-blue-800" // Activo Azul
                  : "text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800", // Inactivo
              ]}
              href={link.href}
            >
              <span class={isActive ? "text-blue-500" : "text-slate-400"}>
                ./
              </span>
              <span>{link.label}</span>
            </a>
          );
        })
      }
    </div>
  </div>
</header>
